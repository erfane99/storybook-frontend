(()=>{var e={};e.id=901,e.ids=[901],e.modules={3244:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=3244,e.exports=r},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},6950:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>l}),t(650),t(5931),t(5866);var s=t(3191),i=t(8716),a=t(7922),o=t.n(a),n=t(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(r,d);let l=["",{children:["storybook",{children:["[id]",{children:["view",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,650)),"/home/project/app/storybook/[id]/view/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5931)),"/home/project/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/project/app/storybook/[id]/view/page.tsx"],p="/storybook/[id]/view/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/storybook/[id]/view/page",pathname:"/storybook/[id]/view",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},5266:(e,r,t)=>{Promise.resolve().then(t.bind(t,1652))},1652:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(326),i=t(7577),a=t(5047),o=t(2643),n=t(772),d=t(8617),l=t(4215),c=t(683),p=t(6333),u=t(6993),m=t(1540);let h=(0,t(2881).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=t(2945);t(6824);let y={children:"For Children",young_adults:"For Young Adults",adults:"For Adults"};function g(){(0,a.useParams)();let e=(0,a.useRouter)(),{user:r,profile:t}=(0,c.a)(),{toast:g}=(0,l.pm)(),[f,b]=(0,i.useState)(null),[j,v]=(0,i.useState)(!0);(0,x.x)();let N=async()=>{if(!r?.email_confirmed_at){e.push("/auth/verify");return}if(t?.onboarding_step==="paid")try{let e=`${window.location.origin}/storybook/${f?.id}/view`;await navigator.clipboard.writeText(e),g({title:"Link copied",description:"Share link copied to clipboard"})}catch(e){g({variant:"destructive",title:"Error",description:"Failed to copy share link"})}};if(!r)return null;let w=e=>{switch(e){case 1:default:return"grid-cols-1";case 2:return"grid-cols-1 sm:grid-cols-2";case 3:return"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"}};return s.jsx("div",{className:"min-h-screen bg-background py-12",children:(0,s.jsxs)("div",{className:"container max-w-7xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(n.z,{variant:"ghost",onClick:()=>e.push("/storybook/library"),children:[s.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Back to Library"]}),j?s.jsx(d.O,{className:"h-8 w-64"}):(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-4xl font-bold",children:f?.title}),s.jsx("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:s.jsx("span",{children:y[f?.audience||"children"]})})]})]}),!j&&f&&s.jsx("div",{className:"flex items-center gap-2",children:t?.onboarding_step==="paid"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.z,{variant:"outline",onClick:N,children:[s.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Share"]}),(0,s.jsxs)(n.z,{variant:"outline",onClick:()=>{if(!r?.email_confirmed_at){e.push("/auth/verify");return}t?.onboarding_step==="paid"&&g({title:"Download started",description:"Your storybook will be downloaded shortly"})},children:[s.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Download"]})]}):s.jsx(o.Zb,{className:"p-4 bg-muted",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx(h,{className:"h-5 w-5 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-sm font-medium",children:"Unlock sharing and downloading"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Purchase this storybook to access all features"})]}),s.jsx(n.z,{variant:"default",className:"ml-4",children:"Unlock Now"})]})})})]}),j?s.jsx("div",{className:"space-y-8",children:[1,2,3].map(e=>(0,s.jsxs)(o.Zb,{children:[s.jsx(o.Ol,{children:s.jsx(d.O,{className:"h-6 w-32"})}),s.jsx(o.aY,{children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[1,2].map(e=>s.jsx(d.O,{className:"h-64"},e))})})]},e))}):f?(0,s.jsxs)("div",{className:"space-y-12",children:[f.character_description&&(0,s.jsxs)(o.Zb,{children:[s.jsx(o.Ol,{children:s.jsx(o.ll,{children:"Main Character"})}),s.jsx(o.aY,{children:s.jsx("p",{className:"text-muted-foreground",children:f.character_description})})]}),f.pages.map((e,r)=>(0,s.jsxs)(o.Zb,{children:[s.jsx(o.Ol,{children:(0,s.jsxs)(o.ll,{children:["Page ",r+1]})}),s.jsx(o.aY,{children:s.jsx("div",{className:`grid ${w(e.scenes.length)} gap-6`,children:e.scenes.map((e,r)=>(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("div",{className:"aspect-video relative rounded-lg overflow-hidden",children:s.jsx("img",{src:e.generatedImage,alt:`Scene ${r+1}`,className:"absolute inset-0 w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-lg",children:e.description}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Emotion: ",e.emotion]})]})]},r))})})]},r))]}):s.jsx(o.Zb,{children:s.jsx(o.aY,{className:"py-8 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Storybook not found"})})})]})})}},2643:(e,r,t)=>{"use strict";t.d(r,{Ol:()=>n,SZ:()=>l,Zb:()=>o,aY:()=>c,eW:()=>p,ll:()=>d});var s=t(326),i=t(7577),a=t(7863);let o=i.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));o.displayName="Card";let n=i.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...r}));n.displayName="CardHeader";let d=i.forwardRef(({className:e,...r},t)=>s.jsx("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));d.displayName="CardTitle";let l=i.forwardRef(({className:e,...r},t)=>s.jsx("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let c=i.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,a.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let p=i.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",e),...r}));p.displayName="CardFooter"},8617:(e,r,t)=>{"use strict";t.d(r,{O:()=>a});var s=t(326),i=t(7863);function a({className:e,...r}){return s.jsx("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",e),...r})}},6824:(e,r,t)=>{"use strict";async function s(e,r={}){let t=function(e){let r=e.startsWith("/")?e.slice(1):e;return`https://storybook-backend-production-cb71.up.railway.app/${r}`}(e),s={headers:{"Content-Type":"application/json",...r.headers},...r};try{let e=await fetch(t,s);if(!e.ok){let r=await e.json().catch(()=>({}));throw Error(r.error||`HTTP ${e.status}: ${e.statusText}`)}return await e.json()}catch(r){throw console.error(`API request failed for ${e}:`,r),r}}t.d(r,{hi:()=>i});let i={sendOTP:e=>s("api/send-otp",{method:"POST",body:JSON.stringify({phone:e})}),verifyOTP:(e,r)=>s("api/verify-otp",{method:"POST",body:JSON.stringify({phone:e,otp_code:r})}),uploadImage:e=>s("api/upload-image",{method:"POST",body:e,headers:{}}),describeImage:e=>s("api/image/describe",{method:"POST",body:JSON.stringify({imageUrl:e})}),cartoonizeImage:(e,r,t)=>s("api/image/cartoonize",{method:"POST",body:JSON.stringify({prompt:e,style:r,imageUrl:t})}),generateScenes:(e,r,t)=>s("api/story/generate-scenes",{method:"POST",body:JSON.stringify({story:e,characterImage:r,audience:t})}),generateAutoStory:e=>s("api/story/generate-auto-story",{method:"POST",body:JSON.stringify(e)}),createStorybook:e=>s("api/story/create-storybook",{method:"POST",body:JSON.stringify(e)}),generateCartoonImage:e=>s("api/story/generate-cartoon-image",{method:"POST",body:JSON.stringify({image_prompt:e})}),getUserStorybooks:e=>s("api/story/get-user-storybooks",{headers:{Authorization:`Bearer ${e}`}}),getUserStorybookById:(e,r)=>s(`api/story/get-user-storybook-by-id?id=${e}`,{headers:{Authorization:`Bearer ${r}`}}),deleteStorybookById:(e,r)=>s(`api/story/delete-by-id?id=${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}}),requestPrint:(e,r)=>s("api/story/request-print",{method:"POST",headers:{Authorization:`Bearer ${r}`},body:JSON.stringify({storybook_id:e})}),startAutoStoryJob:e=>s("api/jobs/auto-story/start",{method:"POST",body:JSON.stringify(e)}),startScenesJob:e=>s("api/jobs/scenes/start",{method:"POST",body:JSON.stringify(e)}),startStorybookJob:e=>s("api/jobs/storybook/start",{method:"POST",body:JSON.stringify(e)}),getUserJobs:e=>s("api/jobs/user",{headers:{Authorization:`Bearer ${e}`}}),cancelJob:e=>s(`api/jobs/cancel/${e}`,{method:"POST"}),deleteJob:(e,r)=>s(`api/jobs/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})}},2945:(e,r,t)=>{"use strict";t.d(r,{x:()=>a});var s=t(8655);let i=null;function a(){return i||(i=(0,s.AY)("https://nzkwrrinpweiqcnzeric.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56a3dycmlucHdlaXFjbnplcmljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MTE3NjYsImV4cCI6MjA2MjE4Nzc2Nn0.6KOABidPThLpLfw_YSKvK8YYwF1srRlaFyczTiRF0i8")),i}},6333:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(2881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1540:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(2881).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},6993:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(2881).Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},650:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`/home/project/app/storybook/[id]/view/page.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[759,655,474],()=>t(6950));module.exports=s})();