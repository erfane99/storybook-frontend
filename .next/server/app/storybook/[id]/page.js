(()=>{var e={};e.id=92,e.ids=[92],e.modules={3244:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=3244,e.exports=t},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},6085:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l}),r(5962),r(5931),r(5866);var s=r(3191),a=r(8716),o=r(7922),i=r.n(o),n=r(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(t,d);let l=["",{children:["storybook",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5962)),"/home/project/app/storybook/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,5931)),"/home/project/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/project/app/storybook/[id]/page.tsx"],u="/storybook/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/storybook/[id]/page",pathname:"/storybook/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},5749:(e,t,r)=>{Promise.resolve().then(r.bind(r,601))},601:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var s=r(326),a=r(7577),o=r(5047),i=r(2643),n=r(772),d=r(567),l=r(6333),c=r(1890),u=r(9183);let m=(0,r(2881).Z)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var p=r(7506),x=r(7863),h=r(9440),g=r(4215),f=r(683),y=r(2945),b=r(6824);let j={children:"For Children",young_adults:"For Young Adults",adults:"For Adults"},N={children:{container:"gap-8 p-8",card:"rounded-3xl shadow-lg border-4",image:"rounded-2xl",text:"text-xl font-comic leading-relaxed",emotion:"text-lg font-medium text-primary",grid:"grid-cols-1 md:grid-cols-2 gap-8"},young_adults:{container:"gap-6 p-6",card:"rounded-xl shadow-md border-2",image:"rounded-lg",text:"text-base font-medium leading-snug",emotion:"text-sm font-semibold text-muted-foreground",grid:"grid-cols-1 md:grid-cols-3 gap-6"},adults:{container:"gap-4 p-4",card:"rounded-md shadow-sm border",image:"rounded-sm",text:"text-sm font-serif leading-tight",emotion:"text-xs font-medium text-muted-foreground",grid:"grid-cols-1 md:grid-cols-4 gap-4"}};function v(){(0,o.useParams)();let e=(0,o.useRouter)(),{user:t}=(0,f.a)(),{toast:r}=(0,g.pm)(),[v,w]=(0,a.useState)(null),[k,P]=(0,a.useState)(!0),[S,O]=(0,a.useState)(0),[T,q]=(0,a.useState)(!1),[C,_]=(0,a.useState)(!1),z=(0,y.x)(),J=async()=>{if(t&&v){_(!0);try{let{data:{session:e}}=await z.auth.getSession();if(!e?.access_token)throw Error("No access token available");await b.hi.requestPrint(v.id,e.access_token),r({title:"Print Request Received",description:"We'll contact you shortly to complete the order."}),q(!1)}catch(e){r({variant:"destructive",title:"Error",description:e.message||"Failed to submit print request"})}finally{_(!1)}}};if(!t)return null;let I=v?.pages?.every(e=>e.scenes?.every(e=>e.generatedImage));return(0,s.jsxs)("div",{className:"min-h-screen bg-background py-12",children:[(0,s.jsxs)("div",{className:"container max-w-7xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)(n.z,{variant:"ghost",onClick:()=>e.push("/storybook/library"),children:[s.jsx(l.Z,{className:"h-4 w-4 mr-2"}),"Back to Library"]}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-4xl font-bold",children:k?s.jsx("div",{className:"h-9 w-64 bg-muted animate-pulse rounded"}):v?.title||"Storybook"}),v?.audience&&s.jsx(d.C,{variant:"secondary",className:"mt-2",children:j[v.audience]})]})]}),k?s.jsx("div",{className:"space-y-8",children:[1,2,3].map(e=>(0,s.jsxs)(i.Zb,{children:[s.jsx(i.Ol,{children:s.jsx("div",{className:"h-6 w-32 bg-muted animate-pulse rounded"})}),s.jsx(i.aY,{children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[1,2].map(e=>s.jsx("div",{className:"h-64 bg-muted animate-pulse rounded"},e))})})]},e))}):v?(0,s.jsxs)("div",{className:"space-y-12",children:[v.character_description&&(0,s.jsxs)(i.Zb,{children:[s.jsx(i.Ol,{children:s.jsx(i.ll,{children:"Main Character"})}),s.jsx(i.aY,{children:s.jsx("p",{className:"text-muted-foreground",children:v.character_description})})]}),(0,s.jsxs)(i.Zb,{children:[s.jsx(i.Ol,{className:"bg-primary text-primary-foreground",children:(0,s.jsxs)(i.ll,{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{children:["Page ",S+1," of ",v.pages.length]}),(0,s.jsxs)("span",{className:"text-sm font-normal",children:[v.pages[S]?.scenes.length," Scenes"]})]})}),(0,s.jsxs)(i.aY,{className:(0,x.cn)("p-0",N[v.audience].container),children:[s.jsx("div",{className:(0,x.cn)("grid",N[v.audience].grid),children:v.pages[S]?.scenes.map((e,t)=>s.jsxs("div",{className:x.cn("overflow-hidden transition-transform hover:scale-[1.02]",N[v.audience].card),children:[s.jsx("div",{className:"aspect-video relative",children:s.jsx("img",{src:e.generatedImage,alt:`Scene ${t+1}`,className:x.cn("absolute inset-0 w-full h-full object-cover",N[v.audience].image)})}),s.jsxs("div",{className:"p-4 bg-background/95",children:[s.jsx("p",{className:N[v.audience].text,children:e.description}),s.jsx("p",{className:N[v.audience].emotion,children:e.emotion})]})]},t))}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 border-t",children:[(0,s.jsxs)(n.z,{variant:"outline",onClick:()=>O(e=>e-1),disabled:0===S,children:[s.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Previous Page"]}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",S+1," of ",v.pages.length]}),(0,s.jsxs)(n.z,{variant:"outline",onClick:()=>O(e=>e+1),disabled:S===v.pages.length-1,children:["Next Page",s.jsx(u.Z,{className:"h-4 w-4 ml-2"})]})]})]})]}),s.jsx("div",{className:"flex justify-center space-x-4",children:I&&(0,s.jsxs)(n.z,{onClick:()=>q(!0),className:"bg-primary hover:bg-primary/90",children:[s.jsx(m,{className:"h-4 w-4 mr-2"}),"Print Professionally ($40)"]})})]}):s.jsx(i.Zb,{children:s.jsx(i.aY,{className:"py-8 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Storybook not found"})})})]}),s.jsx(h.aR,{open:T,onOpenChange:q,children:(0,s.jsxs)(h._T,{children:[(0,s.jsxs)(h.fY,{children:[s.jsx(h.f$,{children:"Request Professional Print"}),s.jsx(h.yT,{children:"We'll print and ship a high-quality version of your storybook. This service costs $40. Would you like to proceed?"})]}),(0,s.jsxs)(h.xo,{children:[s.jsx(h.le,{children:"Cancel"}),s.jsx(h.OL,{onClick:J,disabled:C,className:"bg-primary hover:bg-primary/90",children:C?(0,s.jsxs)(s.Fragment,{children:[s.jsx(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Confirm Print Request"})]})]})})]})}},9440:(e,t,r)=>{"use strict";r.d(t,{OL:()=>g,_T:()=>u,aR:()=>d,f$:()=>x,fY:()=>m,le:()=>f,xo:()=>p,yT:()=>h});var s=r(326),a=r(7577),o=r(3996),i=r(7863),n=r(772);let d=o.fC;o.xz;let l=o.h_,c=a.forwardRef(({className:e,...t},r)=>s.jsx(o.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));c.displayName=o.aV.displayName;let u=a.forwardRef(({className:e,...t},r)=>(0,s.jsxs)(l,{children:[s.jsx(c,{}),s.jsx(o.VY,{ref:r,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));u.displayName=o.VY.displayName;let m=({className:e,...t})=>s.jsx("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});m.displayName="AlertDialogHeader";let p=({className:e,...t})=>s.jsx("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});p.displayName="AlertDialogFooter";let x=a.forwardRef(({className:e,...t},r)=>s.jsx(o.Dx,{ref:r,className:(0,i.cn)("text-lg font-semibold",e),...t}));x.displayName=o.Dx.displayName;let h=a.forwardRef(({className:e,...t},r)=>s.jsx(o.dk,{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));h.displayName=o.dk.displayName;let g=a.forwardRef(({className:e,...t},r)=>s.jsx(o.aU,{ref:r,className:(0,i.cn)((0,n.d)(),e),...t}));g.displayName=o.aU.displayName;let f=a.forwardRef(({className:e,...t},r)=>s.jsx(o.$j,{ref:r,className:(0,i.cn)((0,n.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));f.displayName=o.$j.displayName},567:(e,t,r)=>{"use strict";r.d(t,{C:()=>n});var s=r(326);r(7577);var a=r(9360),o=r(7863);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:t,...r}){return s.jsx("div",{className:(0,o.cn)(i({variant:t}),e),...r})}},2643:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>n,SZ:()=>l,Zb:()=>i,aY:()=>c,eW:()=>u,ll:()=>d});var s=r(326),a=r(7577),o=r(7863);let i=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let n=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let d=a.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));d.displayName="CardTitle";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,o.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let u=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},6824:(e,t,r)=>{"use strict";async function s(e,t={}){let r=function(e){let t=e.startsWith("/")?e.slice(1):e;return`https://storybook-backend-production-cb71.up.railway.app/${t}`}(e),s={headers:{"Content-Type":"application/json",...t.headers},...t};try{let e=await fetch(r,s);if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||`HTTP ${e.status}: ${e.statusText}`)}return await e.json()}catch(t){throw console.error(`API request failed for ${e}:`,t),t}}r.d(t,{hi:()=>a});let a={sendOTP:e=>s("api/send-otp",{method:"POST",body:JSON.stringify({phone:e})}),verifyOTP:(e,t)=>s("api/verify-otp",{method:"POST",body:JSON.stringify({phone:e,otp_code:t})}),uploadImage:e=>s("api/upload-image",{method:"POST",body:e,headers:{}}),describeImage:e=>s("api/image/describe",{method:"POST",body:JSON.stringify({imageUrl:e})}),cartoonizeImage:(e,t,r)=>s("api/image/cartoonize",{method:"POST",body:JSON.stringify({prompt:e,style:t,imageUrl:r})}),generateScenes:(e,t,r)=>s("api/story/generate-scenes",{method:"POST",body:JSON.stringify({story:e,characterImage:t,audience:r})}),generateAutoStory:e=>s("api/story/generate-auto-story",{method:"POST",body:JSON.stringify(e)}),createStorybook:e=>s("api/story/create-storybook",{method:"POST",body:JSON.stringify(e)}),generateCartoonImage:e=>s("api/story/generate-cartoon-image",{method:"POST",body:JSON.stringify({image_prompt:e})}),getUserStorybooks:e=>s("api/story/get-user-storybooks",{headers:{Authorization:`Bearer ${e}`}}),getUserStorybookById:(e,t)=>s(`api/story/get-user-storybook-by-id?id=${e}`,{headers:{Authorization:`Bearer ${t}`}}),deleteStorybookById:(e,t)=>s(`api/story/delete-by-id?id=${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),requestPrint:(e,t)=>s("api/story/request-print",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({storybook_id:e})}),startAutoStoryJob:e=>s("api/jobs/auto-story/start",{method:"POST",body:JSON.stringify(e)}),startScenesJob:e=>s("api/jobs/scenes/start",{method:"POST",body:JSON.stringify(e)}),startStorybookJob:e=>s("api/jobs/storybook/start",{method:"POST",body:JSON.stringify(e)}),getUserJobs:e=>s("api/jobs/user",{headers:{Authorization:`Bearer ${e}`}}),cancelJob:e=>s(`api/jobs/cancel/${e}`,{method:"POST"}),deleteJob:(e,t)=>s(`api/jobs/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})}},2945:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});var s=r(8655);let a=null;function o(){return a||(a=(0,s.AY)("https://nzkwrrinpweiqcnzeric.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56a3dycmlucHdlaXFjbnplcmljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MTE3NjYsImV4cCI6MjA2MjE4Nzc2Nn0.6KOABidPThLpLfw_YSKvK8YYwF1srRlaFyczTiRF0i8")),a}},6333:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1890:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},5962:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/home/project/app/storybook/[id]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[759,655,996,474],()=>r(6085));module.exports=s})();