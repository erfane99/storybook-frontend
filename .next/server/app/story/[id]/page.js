(()=>{var e={};e.id=415,e.ids=[415],e.modules={3244:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=3244,e.exports=t},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},2469:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>l,routeModule:()=>m,tree:()=>c}),r(5304),r(5931),r(5866);var s=r(3191),a=r(8716),i=r(7922),o=r.n(i),d=r(5231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);r.d(t,n);let c=["",{children:["story",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5304)),"/home/project/app/story/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,5931)),"/home/project/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],l=["/home/project/app/story/[id]/page.tsx"],p="/story/[id]/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/story/[id]/page",pathname:"/story/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1836:(e,t,r)=>{Promise.resolve().then(r.bind(r,6615))},6615:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(326),a=r(7577),i=r(5047),o=r(2643),d=r(772),n=r(2945),c=r(8617),l=r(4215),p=r(4527),u=r(6824);function m(){(0,i.useParams)();let[e,t]=(0,a.useState)([]),[r,m]=(0,a.useState)(!0),[h,y]=(0,a.useState)(null),[g,x]=(0,a.useState)(null),b=(0,n.x)(),{toast:f}=(0,l.pm)(),j=async r=>{if(!r.image_prompt){f({variant:"destructive",title:"Error",description:"No image prompt available for this scene"});return}x(r.id);try{let{url:s}=await u.hi.generateCartoonImage(r.image_prompt),{error:a}=await b.from("story_scenes").update({generated_image_url:s}).eq("id",r.id);if(a)throw a;t(e.map(e=>e.id===r.id?{...e,generated_image_url:s}:e)),f({title:"Success",description:"Image generated successfully!"})}catch(e){f({variant:"destructive",title:"Error",description:e.message||"Failed to generate image"})}finally{x(null)}};return r?(0,s.jsxs)("div",{className:"container py-8 space-y-6",children:[s.jsx(c.O,{className:"h-12 w-[250px]"}),s.jsx("div",{className:"grid gap-6",children:[1,2,3,4].map(e=>s.jsx(c.O,{className:"h-[200px]"},e))})]}):h?s.jsx("div",{className:"container py-8",children:s.jsx(o.Zb,{className:"bg-destructive/10",children:s.jsx(o.aY,{className:"p-6",children:(0,s.jsxs)("p",{className:"text-destructive",children:["Error loading story scenes: ",h]})})})}):(0,s.jsxs)("div",{className:"container py-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Story Scenes"}),s.jsx("div",{className:"grid gap-6",children:e.map(e=>(0,s.jsxs)(o.Zb,{children:[s.jsx(o.Ol,{children:(0,s.jsxs)(o.ll,{children:["Scene ",e.scene_number]})}),(0,s.jsxs)(o.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Scene Description"}),s.jsx("p",{className:"text-muted-foreground",children:e.scene_text})]}),e.image_prompt&&(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Image Prompt"}),s.jsx("p",{className:"text-sm font-mono bg-muted p-4 rounded-lg",children:e.image_prompt})]}),e.generated_image_url?(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Generated Image"}),s.jsx("img",{src:e.generated_image_url,alt:`Scene ${e.scene_number}`,className:"rounded-lg shadow-md w-full"})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 p-8 border-2 border-dashed rounded-lg",children:[s.jsx("p",{className:"text-muted-foreground",children:"No image generated yet"}),(0,s.jsxs)(d.z,{onClick:()=>j(e),disabled:!e.image_prompt||g===e.id,children:[s.jsx(p.Z,{className:"mr-2 h-4 w-4"}),g===e.id?"Generating...":"Generate Image"]})]})]})]},e.id))})]})}},2643:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>d,SZ:()=>c,Zb:()=>o,aY:()=>l,eW:()=>p,ll:()=>n});var s=r(326),a=r(7577),i=r(7863);let o=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));o.displayName="Card";let d=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let n=a.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));n.displayName="CardTitle";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));l.displayName="CardContent";let p=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));p.displayName="CardFooter"},8617:(e,t,r)=>{"use strict";r.d(t,{O:()=>i});var s=r(326),a=r(7863);function i({className:e,...t}){return s.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...t})}},6824:(e,t,r)=>{"use strict";async function s(e,t={}){let r=function(e){let t=e.startsWith("/")?e.slice(1):e;return`https://storybook-backend-production-cb71.up.railway.app/${t}`}(e),s={headers:{"Content-Type":"application/json",...t.headers},...t};try{let e=await fetch(r,s);if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||`HTTP ${e.status}: ${e.statusText}`)}return await e.json()}catch(t){throw console.error(`API request failed for ${e}:`,t),t}}r.d(t,{hi:()=>a});let a={sendOTP:e=>s("api/send-otp",{method:"POST",body:JSON.stringify({phone:e})}),verifyOTP:(e,t)=>s("api/verify-otp",{method:"POST",body:JSON.stringify({phone:e,otp_code:t})}),uploadImage:e=>s("api/upload-image",{method:"POST",body:e,headers:{}}),describeImage:e=>s("api/image/describe",{method:"POST",body:JSON.stringify({imageUrl:e})}),cartoonizeImage:(e,t,r)=>s("api/image/cartoonize",{method:"POST",body:JSON.stringify({prompt:e,style:t,imageUrl:r})}),generateScenes:(e,t,r)=>s("api/story/generate-scenes",{method:"POST",body:JSON.stringify({story:e,characterImage:t,audience:r})}),generateAutoStory:e=>s("api/story/generate-auto-story",{method:"POST",body:JSON.stringify(e)}),createStorybook:e=>s("api/story/create-storybook",{method:"POST",body:JSON.stringify(e)}),generateCartoonImage:e=>s("api/story/generate-cartoon-image",{method:"POST",body:JSON.stringify({image_prompt:e})}),getUserStorybooks:e=>s("api/story/get-user-storybooks",{headers:{Authorization:`Bearer ${e}`}}),getUserStorybookById:(e,t)=>s(`api/story/get-user-storybook-by-id?id=${e}`,{headers:{Authorization:`Bearer ${t}`}}),deleteStorybookById:(e,t)=>s(`api/story/delete-by-id?id=${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),requestPrint:(e,t)=>s("api/story/request-print",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({storybook_id:e})}),startAutoStoryJob:e=>s("api/jobs/auto-story/start",{method:"POST",body:JSON.stringify(e)}),startScenesJob:e=>s("api/jobs/scenes/start",{method:"POST",body:JSON.stringify(e)}),startStorybookJob:e=>s("api/jobs/storybook/start",{method:"POST",body:JSON.stringify(e)}),getUserJobs:e=>s("api/jobs/user",{headers:{Authorization:`Bearer ${e}`}}),cancelJob:e=>s(`api/jobs/cancel/${e}`,{method:"POST"}),deleteJob:(e,t)=>s(`api/jobs/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})}},2945:(e,t,r)=>{"use strict";r.d(t,{x:()=>i});var s=r(8655);let a=null;function i(){return a||(a=(0,s.AY)("https://nzkwrrinpweiqcnzeric.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56a3dycmlucHdlaXFjbnplcmljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MTE3NjYsImV4cCI6MjA2MjE4Nzc2Nn0.6KOABidPThLpLfw_YSKvK8YYwF1srRlaFyczTiRF0i8")),a}},4527:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]])},5304:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/home/project/app/story/[id]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[759,655,474],()=>r(2469));module.exports=s})();